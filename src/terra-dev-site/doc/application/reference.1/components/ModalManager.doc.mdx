import PropsTable from 'terra-application/lib/modal-manager/ModalManager?dev-site-props-table';

# ModalManager

The ModalManager exposes its children to modal presentation APIs through the [DisclosureManagerContext](/components/terra-application/application/reference/contexts/disclosure-manager-context).

## Usage

```jsx
import ModalManager from 'terra-application/lib/modal-manager';
```

## Props

<PropsTable />

## Features

### Exception Handling

ModalManager renders an [ApplicationErrorBoundary](/components/terra-application/application/reference/components/application-error-boundary) around its disclosed components. If the disclosed components throw exceptions during React lifecycle functions, ModalManager will catch the exceptions and render a styled error component in place of the children.

> If the disclosed modal contents render their own modal header, it is recommended that those components render an additional ApplicationErrorBoundary below their modal header to keep the header controls for modal dismissal exposed.

### Loading Overlays

ModalManager renders an [ApplicationLoadingOverlayProvider](/components/terra-application/application/reference/components/application-loading-overlay) around its disclosed components. Any [ApplicationLoadingOverlay](/components/terra-application/application/reference/components/application-loading-overlay) components rendered by children will result in loading overlays being rendered by ApplicationBase.

> If the disclosed modal contents render their own modal header, it is recommended that those components render an additional ApplicationLoadingOverlayProvider below their modal header to keep the header controls for modal dismissal exposed while the overlay is active.

### Pending Actions

ModalManager monitors its disclosed content for the presence of rendered [NavigationPrompts](/components/terra-application/application/reference/components/navigation-prompt) within its disclosed content. ModalManager will ensure that the user is prompted prior to dismissing the presented modal if any [NavigationPrompts](/components/terra-application/application/reference/components/navigation-prompt) are rendered at the time of the dismissal request.

## Details

### Implementation Requirements

The ModalManager utilizes the DisclosureManager to manage disclosure requests. The components provided as children to the ModalManager, and the components disclosed within it, must interface with the ModalManager's context using the `withDisclosureManager()` higher-order component generator provided by this package. Alternatively, `DisclosureManagerContext` can be consumed directly using the `useContext` hook.

The ModalManager responds to `"modal"` disclosure type requests. Components that wish to disclose content using the ModalManager should provide a preferred type of `"modal"`. This value is exported from the package as `disclosureType`.

### DisclosureManagerHeaderAdapter Support

If a component disclosed by the ModalManager renders a `DisclosureManagerHeaderAdapter`, the ModalManager will render an ActionHeader and provide the standard disclosure navigation controls (close, go back, maximize/minimize, etc.) within it. The disclosed component can use the `DisclosureManagerHeaderAdapter` to inject its own title and CollapsibleButtonView into the ActionHeader.

If the disclosed component does **not** render a `DisclosureManagerHeaderAdapter`, the ModalManager will **not** render an ActionHeader itself. In this case, it is assumed that the disclosed component is rendering its own header. The disclosed component is responsible for rendering the appropriate controls to navigate the disclosure stack.
s
> Note: The DisclosureManagerHeaderAdapter is the preferred way to present a header within the ModalManager. In a future major release, the ModalManager will **always** render the header and navigation controls, regardless of the presence of a DisclosureManagerHeaderAdapter.

### Disclosure Accessory

The `disclosureAccessory` prop allows consumers of the ModalManager to render a static component above the disclosed modal content. The provided component will be rendered below the standard ActionHeader and above the disclosed content. This can be used to easily provide additional context to every disclosed component. This component is provided once to the ModalManager instance, not on a per-disclosure basis, and each component in the disclosure stack will be decorated with the same accessory component.

### Example

```jsx
import React from 'react';
import Button from 'terra-button';
import ModalManager, { disclosureType } from 'terra-application/lib/modal-manager';
import { withDisclosureManager, DisclosureManagerContext, DisclosureManagerHeaderAdapter } from 'terra-application/lib/disclosure-manager';
import CollapsibleMenuView from 'terra-collapsible-menu-view';

const ModalComponentB = () => (
  <React.Fragment>
    <DisclosureManagerHeaderAdapter
      title="Modal Component B"
    />
    <p>I am ModalComponentB!</p>
  </React.Fragment>
);

const ModalComponentA = () => {
  const disclosureManager = React.useContext(DisclosureManagerContext);

  return (
    <div>
      <DisclosureManagerHeaderAdapter
        title="Modal Component A"
        collapsibleMenuView={<CollapsibleMenuView />}
      />
      <p>I am ModalComponentA!</p>
      <Button
        text="Disclose ModalComponentB"
        onClick={() => {
          disclosureManager.disclose({
            preferredType: 'modal',
            size: 'large',
            content: {
              key: 'modal-component-b-instance',
              component: <ModalComponentB />
            }
          });
        }}
      />
    </div>
  );
}

const MyContentComponent = withDisclosureManager(({ disclosureManager }) => (
  <div>
    <p>I am MyContentComponent!</p>
    <Button
      text="Disclose ModalComponentA"
      onClick={() => {
        disclosureManager.disclose({
          preferredType: 'modal',
          size: 'large',
          content: {
            key: 'modal-component-a-instance',
            component: <ModalComponentA />
          }
        });
      }}
    />
  </div>
));

MyContentComponent.propTypes = {
  disclosureManager: disclosureManagerShape,
}

let MyModalManagerComponent = () => (
  <ModalManager
    disclosureAccessory={<div>Disclosure Accessory</div>}
  >
    <MyContentComponent />
  </ModalManager>
);
```
