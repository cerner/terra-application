import ExampleComponent from './example/ExampleComponent?dev-site-example';

# Theming Guide

Welcome to the Terra theming strategy guide. This guide will walk teams through the recommended approach for theming custom components.

## Summary

Terra supports a default, clinical-lowlight-theme, and orion-fusion-theme. This guide is for theming custom components. Custom components are any non Terra-UI component created by teams that need to be integrated into an application using a supported Terra theme. Teams should not create new themes or theme Terra components.

## Getting Started

To get started, check out the [terra-application](http://engineering.cerner.com/terra-application/components/terra-application/application/reference/components/application-base) documentation. For this guide, it is expected that teams are utilizing an application framework that defines a theme provider. This guide will walk through theming an example component.

## Theme Context

An application's theme is provided through [React context](https://reactjs.org/docs/context.html) by a theme provider. [Application Base](http://engineering.cerner.com/terra-application/components/terra-application/application/reference/components/application-base) initializes a theme provider automatically. The theme value is accessed using the [theme context](http://engineering.cerner.com/terra-application/components/terra-application/application/reference/contexts/theme-context) from terra-application.

```jsx
import { ThemeContext } from 'terra-application/lib/theme';
```

Use the theme context to read the active theme value.

```jsx
import { ThemeContext } from 'terra-application/lib/theme';

const ExampleComponent = () => {
  // Access the active theme context value.
  const theme = useContext(ThemeContext);
};
```

The active theme name is stored in a `className` key in the context value. To apply the theme, bind the theme className to the component using [classnames](https://github.com/JedWatson/classnames). Some additional documentation for CSS Modules and classNames can be found on the [conventions page](https://engineering.cerner.com/terra-ui/contributing/terra-ui/conventions). Please note that an empty or undefined className indicates the default theme is active or a theme provider is missing. The `className` key maps directly to the anticipated theme name. Using the correct theme className is required.

```jsx
import React from 'react';
import classNames from 'classnames/bind';
import { ThemeContext } from 'terra-application/lib/theme';
import styles from './ThemedComponent.module.scss';

const cx = classNames.bind(styles);

const ExampleComponent = () => {
  const theme = React.useContext(ThemeContext);

  return (
    <div className={cx('example-component', theme.className)}>
      This is an example component.
    </div>
  );
};
```

## SCSS

Once the theme className has been bound, the component can be appropriately themed. Start by defining the variables for the CSS properties that are expected to change between themes. SCSS variables are defined using [custom properties](https://developer.mozilla.org/en-US/docs/Web/CSS/--*). These values should utilize the SCSS [var()](https://developer.mozilla.org/en-US/docs/Web/CSS/var) functionality. The var() function works by applying a variable if the value has been set. If no value has been set the default value is used.

`example-component/ExampleComponent.module.scss`

```scss
// The values in this file represent the default theme. The default theme is applied using the default values in the var() function.
:local {
  .example-component {
    background-color: var(--terra-application-example-component-background-color, #fff);
    color: var(--terra-application-example-component-color, inherit);
    font-size: var(--terra-application-example-component-font-size, 1rem);
  }
}
```

To add themes, create new files for each theme and include them in the original SCSS file. Theme files define variables that apply when the theme becomes active. Themes must be locally scoped and must use a supported theme class names.

`example-component/ExampleComponent.orion-fusion-theme.module.scss`

```scss
:local {
  .orion-fusion-theme {
    --terra-application-example-component-background-color: #f6f8fa;
    --terra-application-example-component-color: rgb(36, 41, 46);
    --terra-application-example-component-font-size: 2rem;
  }
}
```

`example-component/ExampleComponent.clinical-lowlight-theme.module.scss`

```scss
:local {
  .clinical-lowlight-theme {
    --terra-application-example-component-background-color: rgb(34, 42, 46);
    --terra-application-example-component-color: rgb(178, 181, 182);
    --terra-application-example-component-font-size: 1rem;
  }
}
```

Include the new theme files in the original SCSS file.

`example-component/ExampleComponent.module.scss`

```scss
// Import each theme.
@import './ExampleComponent.clinical-lowlight-theme.module';
@import './ExampleComponent.orion-fusion-theme.module';

:local {
  .example-component {
    background-color: var(--terra-application-example-component-background-color, #fff);
    color: var(--terra-application-example-component-color, inherit);
    font-size: var(--terra-application-example-component-font-size, 1rem);
  }
}
```

The recommended file structure ends up looking like this:

```
.
├── example-component
│   ├── ExampleComponent.clinical-lowlight-theme.module.scss
│   ├── ExampleComponent.jsx
│   ├── ExampleComponent.module.scss
│   └── ExampleComponent.orion-fusion-theme.module.scss
```

## Webpack

To enable themes, teams must define a terra-theme.config.js configuration file. This file is read by the [terra-toolkit postcss loader](https://github.com/cerner/terra-toolkit/tree/master/config/webpack/postcss) to aggregate themes. This file must be defined for theme CSS assets to be included in the webpack bundle. The loader runs automatically for webpack configurations using terra-toolkit's webpack config.

```js
const themeConfig = {
  theme: 'terra-dark-theme', // The default theme to be enabled on page load.
  scoped: ['terra-light-theme', 'terra-lowlight-theme'], // An array of scoped themes. Note: Scoped themes do not work in IE 10.
};

module.exports = themeConfig;
```

## Example

Toggle the theme from the dropdown at the top of the page to see changes. The full example code can be seen [here](https://github.com/cerner/terra-application/tree/master/src/terra-dev-site/doc/application/how-to.2/example).

<ExampleComponent />

## FAQ

### Are Terra Theme Variables Reusable?

No, theme variables are considered private and should never be used by consuming applications. Do not use Terra theme variables in custom CSS.

### Is It Okay To Override Terra Component Styles?

It is not recommended to override Terra component styles. The exceptions are layout and positioning concerns such as width or margins.

### Do I Have To Use Terra ToolKit's Webpack Configuration?

It is highly recommended that teams use the terra-toolkit webpack configuration to ensure the appropriate loaders are used.

### Can I Use Multiple Themes Providers At Once?

Technically yes, officially no. Most themes depend on the base font-size set on the html element. Only one font-size can be applied to the base html element. Nested theme providers will not apply a correct font-size. This will impact any rem based CSS (padding, margins, line-heights, etc...).

### Can I Create An Entirely New Theme?

No, the internal implementation of Terra components is considered private and changes frequently. Terra provides all supported themes.
